{"version":3,"sources":["server.ts"],"names":["express_1","require","body_parser_1","compression_1","cors_1","mongoose_1","path_1","dotenv_1","image_route_1","app","config","use","credentials","json","urlencoded","extended","static","join","__dirname","connect","process","env","MONGO_URL","then","console","log","err","req","res","next","name","status","message","PORT","listen"],"mappings":"mCAAA,IAAAA,UAAAC,QAAA,WAOAC,cAAAD,QAAA,eACAE,cAAAF,QAAA,eACAG,OAAAH,QAAA,QACAI,WAAAJ,QAAA,YACAK,OAAAL,QAAA,QACAM,SAAAN,QAAA,UACAO,cAAAP,QAAA,wBAEMQ,IAAMT,UAAA,UACZO,SAAAG,SAGAD,IAAIE,IACFP,OAAA,QAAK,CACHQ,aAAa,KAGjBH,IAAIE,IAAIR,cAAA,WACRM,IAAIE,IAAIT,cAAA,QAAWW,QACnBJ,IAAIE,IAAIX,UAAA,QAAQa,QAChBJ,IAAIE,IAAIX,UAAA,QAAQc,WAAW,CAAEC,UAAU,KAGvCN,IAAIE,IAAI,YAAaX,UAAA,QAAQgB,OAAOV,OAAA,QAAKW,KAAKC,UAAW,cAGzDb,WAAA,QACGc,QAAQC,QAAQC,IAAIC,WACpBC,KAAK,WAAM,OAAAC,QAAQC,IAAI,yBAA0BL,QAAQC,IAAIC,aACxD,MAAC,SAACI,GACNF,QAAQC,IAAIC,KAIhBjB,IAAIE,IAAI,OAAQH,cAAA,SAEhBC,IAAIE,IACF,SACEe,EACAC,EACAC,EACAC,GAEiB,qBAAbH,EAAII,OACNF,EAAIG,OAAO,KAAKlB,KAAK,CAAEmB,QAAS,4BAChCH,KAGe,oBAAbH,EAAII,OACLF,EACEG,OAAO,KACPlB,KAAK,CAAEmB,QAAS,4CAEjBH,KAGJA,MAIJ,IAAMI,KAAOb,QAAQC,IAAIY,MAAQ,IACjCT,QAAQC,IAAI,wBAAyBQ,MACrCxB,IAAIyB,OAAOD","file":"server.min.js","sourcesContent":["import express, {\r\n  Request,\r\n  Response,\r\n  Errback,\r\n  ErrorRequestHandler,\r\n  NextFunction,\r\n} from \"express\";\r\nimport bodyParser from \"body-parser\";\r\nimport compression from \"compression\";\r\nimport cors from \"cors\";\r\nimport mongoose from \"mongoose\";\r\nimport path from \"path\";\r\nimport { config } from \"dotenv\";\r\nimport imgRouter from \"./router/image-route\";\r\n\r\nconst app = express();\r\nconfig();\r\n\r\n//middleware\r\napp.use(\r\n  cors({\r\n    credentials: true,\r\n  })\r\n);\r\napp.use(compression());\r\napp.use(bodyParser.json());\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n//image folder route\r\napp.use(\"/codetest\", express.static(path.join(__dirname, \"codetest\")));\r\n\r\n//connect to mongodb\r\nmongoose\r\n  .connect(process.env.MONGO_URL!)\r\n  .then(() => console.log(\"connected with MONGODB\", process.env.MONGO_URL))\r\n  .catch((err) => {\r\n    console.log(err);\r\n  });\r\n\r\n// api path\r\napp.use(\"/api\", imgRouter);\r\n//checking image type and response\r\napp.use(\r\n  (\r\n    err: ErrorRequestHandler,\r\n    req: Request,\r\n    res: Response,\r\n    next: NextFunction\r\n  ) => {\r\n    if (err.name === \"LIMIT_FILE_TYPES\") {\r\n      res.status(422).json({ message: \"Only images are allowed\" });\r\n      next();\r\n    }\r\n\r\n    if (err.name === \"LIMIT_FILE_SIZE\") {\r\n       res\r\n        .status(422)\r\n        .json({ message: \"Too large. Max size is allowed only 5MB\" });\r\n\r\n        next();\r\n    }\r\n\r\n    next();\r\n  }\r\n);\r\n\r\nconst PORT = process.env.PORT || 5000;\r\nconsole.log(\"server is running on \", PORT);\r\napp.listen(PORT);\r\n"]}