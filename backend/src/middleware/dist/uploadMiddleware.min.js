"use strict";exports.__esModule=!0;var multer_1=require("multer"),aws_sdk_1=require("aws-sdk"),multer_sharp_s3_1=require("multer-sharp-s3"),path_1=require("path"),dotenv_1=require("dotenv");dotenv_1.config();var _a=process.env,S3_ENDPOINT=_a.S3_ENDPOINT,BUCKET_NAME=_a.BUCKET_NAME,spacesEndpoint=new aws_sdk_1.default.Endpoint(S3_ENDPOINT),s3=new aws_sdk_1.default.S3({endpoint:spacesEndpoint}),storageposts=multer_sharp_s3_1.default({s3:s3,dirname:"/",Bucket:BUCKET_NAME+"/codetest",ACL:"public-read",resize:{width:850,height:700},max:!0,limits:{fileSize:5242880},metadata:function(e,t,a){a(null,{fieldname:t.fieldname})},Key:function(e,t,a){a(null,(new Date).toISOString().replace(/:/g,"-")+"-"+t.originalname)}}),filefilter=function(e,t,a){var r=/jpeg|jpg|png|gif/,s=r.test(path_1.default.extname(t.originalname).toLocaleLowerCase());if(r.test(t.mimetype)&&s)return a(null,!0);return a("Wrong file Type",!1)},uploadImgs=multer_1.default({storage:storageposts,fileFilter:filefilter}).array("files");exports.UploadData={uploadImgs:uploadImgs,s3:s3};
//# sourceMappingURL=uploadMiddleware.min.js.map
